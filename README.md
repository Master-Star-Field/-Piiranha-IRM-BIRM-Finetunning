# –£—Å—Ç–æ–π—á–∏–≤–æ–µ –∫ —Å–¥–≤–∏–≥—É –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ PII –≤ –ª–æ–≥–∞—Ö —Å –ø–æ–º–æ—â—å—é Invariant Risk Minimization

![Python](https://img.shields.io/badge/Python-3.9%2B-blue.svg)
![Jupyter Notebook](https://img.shields.io/badge/Jupyter-Notebook-orange)
![License](https://img.shields.io/badge/License-MIT-green.svg)

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ—Å–≤—è—â–µ–Ω –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é –º–µ—Ç–æ–¥–æ–≤ —Ä–æ–±–∞—Å—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∑–∞–¥–∞—á–∏ NER (Named Entity Recognition), –∞ –∏–º–µ–Ω–Ω–æ ‚Äî –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –ò–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ–º—ã—Ö –î–∞–Ω–Ω—ã—Ö (PII) –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ª–æ–≥–∞—Ö.

–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫ –º–æ–¥–µ–ª–∏, –æ–±—É—á–µ–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–æ–≤ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (IRM, B-IRM), —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —É—Å—Ç–æ–π—á–∏–≤—ã–º–∏ –∫ **—Å–¥–≤–∏–≥—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö** –∏ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, –æ—Ç–ª–∏—á–∞—é—â–∏—Ö—Å—è –æ—Ç –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏.

## üìú –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–ü—Ä–æ–±–ª–µ–º–∞: –°–¥–≤–∏–≥ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –ª–æ–∂–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏](#-–ø—Ä–æ–±–ª–µ–º–∞-—Å–¥–≤–∏–≥-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è-–∏-–ª–æ–∂–Ω—ã–µ-–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏)
- [–ü–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é: –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ](#-–ø–æ–¥—Ö–æ–¥-–∫-—Ä–µ—à–µ–Ω–∏—é-–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ)
  - [Baseline (ERM)](#baseline-erm)
  - [Invariant Risk Minimization (IRM)](#invariant-risk-minimization-irm)
  - [Balanced-IRM (B-IRM)](#balanced-irm-b-irm)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
- [–ù–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö](#-–Ω–∞–±–æ—Ä—ã-–¥–∞–Ω–Ω—ã—Ö)
- [–ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã](#-–ø—Ä–æ—Ü–µ—Å—Å-–æ–±—É—á–µ–Ω–∏—è-–∏-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- [–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å](#-–∫–∞–∫-–∑–∞–ø—É—Å—Ç–∏—Ç—å)
- [–î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏](#-–¥–∞–ª—å–Ω–µ–π—à–∏–µ-—à–∞–≥–∏)

## üéØ –ü—Ä–æ–±–ª–µ–º–∞: –°–¥–≤–∏–≥ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –ª–æ–∂–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏

–ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞–ø—Ä—è–º—É—é –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω–∏ —Ç–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è, –ø–æ—Ö–æ–∂–∏ –Ω–∞ —Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏. –ö–æ–≥–¥–∞ —ç—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–ª–∏—á–∞—é—Ç—Å—è, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **—Å–¥–≤–∏–≥ –¥–∞–Ω–Ω—ã—Ö**, –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –º–æ–∂–µ—Ç —Ä–µ–∑–∫–æ —É–ø–∞—Å—Ç—å.

–ü—Ä–∏—á–∏–Ω–∞ —ç—Ç–æ–≥–æ –≤ —Ç–æ–º, —á—Ç–æ –º–æ–¥–µ–ª–∏ —á–∞—Å—Ç–æ –≤—ã—É—á–∏–≤–∞—é—Ç **–ª–æ–∂–Ω—ã–µ (spurious) –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏** ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∞ –Ω–µ –æ—Ç —Å–∞–º–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–±—ä–µ–∫—Ç–∞.

**–ü—Ä–∏–º–µ—Ä –∏–∑ –¥—Ä—É–≥–æ–π –æ–±–ª–∞—Å—Ç–∏:** –ú–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∂–∏–≤–æ—Ç–Ω—ã—Ö –Ω–∞—É—á–∏–ª–∞—Å—å –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤–µ—Ä–±–ª—é–¥–æ–≤ –ø–æ –ø–µ—Å—á–∞–Ω–æ–º—É —Ñ–æ–Ω—É, –∞ –Ω–µ –ø–æ –∏—Ö –∞–Ω–∞—Ç–æ–º–∏—á–µ—Å–∫–∏–º –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º. –ù–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤–µ—Ä–±–ª—é–¥–∞ –≤ –∑–æ–æ–ø–∞—Ä–∫–µ —Ç–∞–∫–∞—è –º–æ–¥–µ–ª—å –¥–∞—Å—Ç —Å–±–æ–π.

![Image Classification Problem](images/animal_classification_diagram.jpg)

*(–†–∏—Å. 1 - –ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º—ã: –º–æ–¥–µ–ª—å –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —Ñ–æ–Ω (—Å—Ä–µ–¥—É), –∞ –Ω–µ –Ω–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –æ–±—ä–µ–∫—Ç–∞)*

–í –Ω–∞—à–µ–π –∑–∞–¥–∞—á–µ (–ø–æ–∏—Å–∫ PII –≤ –ª–æ–≥–∞—Ö) —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –Ω–∞—É—á–∏—Ç—å—Å—è –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å EMAIL –ø–æ —Ñ–æ—Ä–º–∞—Ç—É –ª–æ–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `json`) –∏–ª–∏ –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É (`"user_email": ...`), –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∞–º—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É email-–∞–¥—Ä–µ—Å–∞. –¢–∞–∫–∞—è –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –±–µ—Å–ø–æ–ª–µ–∑–Ω–∞ –Ω–∞ –ª–æ–≥–∞—Ö –¥—Ä—É–≥–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞.

## üí° –ü–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é: –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

–ß—Ç–æ–±—ã –∑–∞—Å—Ç–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—å **–∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**, –Ω–µ –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç –æ–∫—Ä—É–∂–µ–Ω–∏—è, –º—ã –ø—Ä–∏–º–µ–Ω—è–µ–º –º–µ—Ç–æ–¥—ã —Ä–æ–±–∞—Å—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –î–ª—è —ç—Ç–æ–≥–æ –º—ã —Ä–∞–∑–¥–µ–ª—è–µ–º –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ä–∞–∑–Ω—ã–µ **—Å—Ä–µ–¥—ã** (environments) ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏ —Ä–∞–∑–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ (JSON, CSV, TXT) ‚Äî –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–ª–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–æ –≤ –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö.

–ú—ã —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ç—Ä–∏ –ø–æ–¥—Ö–æ–¥–∞:

### Baseline (ERM)

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (Empirical Risk Minimization), –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –º–æ–¥–µ–ª—å `rubert-tiny2` –¥–æ–æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –≤—Å–µ–º —Å–º–µ—à–∞–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö. –ú–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –¥–∞–Ω–Ω—ã–º–∏, –ø–æ—Ö–æ–∂–∏–º–∏ –Ω–∞ –æ–±—É—á–∞—é—â–∏–µ, –Ω–æ —É—è–∑–≤–∏–º–∞ –∫ —Å–¥–≤–∏–≥—É.

> **Notebook:** `baseline.ipynb`

### Invariant Risk Minimization (IRM)

–ú–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤–≤–æ–¥–∏—Ç –≤ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —à—Ç—Ä–∞—Ñ. –≠—Ç–æ—Ç —à—Ç—Ä–∞—Ñ –Ω–∞–∫–∞–∑—ã–≤–∞–µ—Ç –º–æ–¥–µ–ª—å, –µ—Å–ª–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã –æ—à–∏–±–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥ —Å–∏–ª—å–Ω–æ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è. –≠—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—å —Ç–∞–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –¥–ª—è –≤—Å–µ—Ö —Å—Ä–µ–¥ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

–ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ IRM –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π —Å –±–æ–ª—å—à–∏–º —á–∏—Å–ª–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–∫–∞–∫ —É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤) —à—Ç—Ä–∞—Ñ –º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –æ–±–Ω—É–ª–∏—Ç—å—Å—è, –∏ –æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ–±—ã—á–Ω—ã–π ERM.

> **Notebook:** `irm_train.ipynb`

### Balanced-IRM (B-IRM)

–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è IRM, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∑–∞—Ç—É—Ö–∞–Ω–∏—è —à—Ç—Ä–∞—Ñ–∞ –∏ –ª—É—á—à–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –±–æ–ª—å—à–∏–º —á–∏—Å–ª–æ–º —Å—Ä–µ–¥. –í–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤, B-IRM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ä–µ–¥—ã, —Å—Ç—Ä–µ–º—è—Å—å –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–∂–¥—É –Ω–∏–º–∏. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –º–æ–¥–µ–ª—å –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤–æ–π –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ—Å—Ç–∏—á—å –ª—É—á—à–µ–π –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.

> **Notebook:** `birm_train.ipynb`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
/
‚îú‚îÄ‚îÄ baseline.ipynb                # –ù–æ—É—Ç–±—É–∫ —Å –¥–æ–æ–±—É—á–µ–Ω–∏–µ–º –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏ (ERM)
‚îú‚îÄ‚îÄ irm_train.ipynb               # –ù–æ—É—Ç–±—É–∫ —Å –¥–æ–æ–±—É—á–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ –ø–æ –º–µ—Ç–æ–¥—É IRM
‚îú‚îÄ‚îÄ birm_train.ipynb              # –ù–æ—É—Ç–±—É–∫ —Å –¥–æ–æ–±—É—á–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ –ø–æ –º–µ—Ç–æ–¥—É B-IRM
‚îú‚îÄ‚îÄ generated_logs_dataset_format.csv # –î–∞—Ç–∞—Å–µ—Ç —Å —à–∞–±–ª–æ–Ω–∞–º–∏ –ª–æ–≥–æ–≤
‚îî‚îÄ‚îÄ generated_pii_dataset_structured.csv # –î–∞—Ç–∞—Å–µ—Ç —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ PII —Å—É—â–Ω–æ—Å—Ç—è–º–∏
```

## üìä –ù–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–∞ —Ñ–∞–π–ª–∞:

- `generated_pii_dataset_structured.csv`: –°–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ PII-—Å—É—â–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ (EMAIL, PHONE, NAME –∏ —Ç.–¥.).
- `generated_logs_dataset_format.csv`: –°–æ–¥–µ—Ä–∂–∏—Ç —à–∞–±–ª–æ–Ω—ã —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ª–æ–≥–æ–≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è PII –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–±—É—á–∞—é—â–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤.

![Data Generation Scheme](images/data_generation_scheme.jpg)

*(–†–∏—Å. 2 - –°—Ö–µ–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ —Å—Ä–µ–¥—ã)*

## üöÄ –ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### Baseline (ERM)

–ú–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é –æ–±—â—É—é —Ç–æ—á–Ω–æ—Å—Ç—å (accuracy), –Ω–æ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤ (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ ‚Äî –Ω–µ PII). –ë–æ–ª–µ–µ –≤–∞–∂–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞, **precision –¥–ª—è PII-–∫–ª–∞—Å—Å–æ–≤**, —Å–æ—Å—Ç–∞–≤–∏–ª–∞ –æ–∫–æ–ª–æ **0.82**.

### IRM

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ IRM –∫ –±–æ–ª—å—à–æ–π —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –ø—Ä–∏–≤–µ–ª–æ –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é. –®—Ç—Ä–∞—Ñ—É—é—â–∞—è —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –±—ã—Å—Ç—Ä–æ –æ–±—Ä–∞—Ç–∏–ª–∞—Å—å –≤ –Ω–æ–ª—å, –∏ –º–æ–¥–µ–ª—å –Ω–µ —Å–º–æ–≥–ª–∞ –≤—ã—É—á–∏—Ç—å –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏.

### B-IRM

–ú–µ—Ç–æ–¥ B-IRM –ø–æ–∫–∞–∑–∞–ª –Ω–∞–∏–ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –ø—Ä–µ–≤–∑–æ–π–¥—è Baseline –ø–æ –≤—Å–µ–º –∫–ª—é—á–µ–≤—ã–º –º–µ—Ç—Ä–∏–∫–∞–º. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —à—Ç—Ä–∞—Ñ–∞ –∏ –±–∞–π–µ—Å–æ–≤—Å–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –ø–æ–∑–≤–æ–ª–∏–ª–æ –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º IRM –∏ –¥–æ–±–∏—Ç—å—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥.

![B-IRM F1-score](images/birm_f1_score_chart.jpg)

*(–†–∏—Å. 3 - F1-–º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è PII-–∫–ª–∞—Å—Å–æ–≤ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ B-IRM)*

![B-IRM Loss](images/birm_loss_chart.jpg)

*(–†–∏—Å. 4 - –î–∏–Ω–∞–º–∏–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ B-IRM)*

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –ø—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏, –æ–±—É—á–µ–Ω–Ω–æ–π —Å –ø–æ–º–æ—â—å—é B-IRM.

![B-IRM Prediction Example](images/prediction_example.jpg)

*(–†–∏—Å. 5 - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ –∏ —Ä–µ–∞–ª—å–Ω—ã—Ö)*

## ‚öôÔ∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone https://github.com/your-username/your-repo-name.git
    cd your-repo-name
    ```

2.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ)
    ```bash
    pip install -r requirements.txt
    ```
    *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —Ñ–∞–π–ª `requirements.txt` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç.*

3.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ Jupyter Notebook:**
    ```bash
    jupyter notebook
    ```

4.  –û—Ç–∫—Ä–æ–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –Ω–æ—É—Ç–±—É–∫–æ–≤: `baseline.ipynb`, `irm_train.ipynb` –∏–ª–∏ `birm_train.ipynb`.

## üîÆ –ß—Ç–æ–±—ã —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã –µ—â–µ —Å–¥–µ–ª–∞—Ç—å

- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç–æ–¥—ã, –∏—Å–ø–æ–ª—å–∑—É—è –¥—Ä—É–≥–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ —Å—Ä–µ–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —è–∑—ã–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –ø–æ –¥–ª–∏–Ω–µ –ª–æ–≥–æ–≤).
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã —Ä–æ–±–∞—Å—Ç–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Ç—Ä–µ–±—É—é—Ç —è–≤–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å—Ä–µ–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Å—Ç—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π).

---
